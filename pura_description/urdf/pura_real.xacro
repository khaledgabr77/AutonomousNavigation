<?xml version="1.0" ?>
<robot name="pura" xmlns:xacro="http://www.ros.org/wiki/xacro">

<xacro:include filename="$(find pura_description)/urdf/materials.xacro" />
<xacro:include filename="$(find pura_description)/urdf/pura.trans" />
<xacro:include filename="$(find pura_description)/urdf/pura.gazebo" />
<xacro:include filename="$(find pura_description)/urdf/pura_imu.urdf.xacro" />
<xacro:include filename="$(find pura_description)/urdf/_d435ii.urdf.xacro"/>
<xacro:include filename="$(find pura_description)/urdf/_d435.urdf.xacro"/>
<xacro:include filename="$(find pura_description)/urdf/_materials.urdf.xacro" />

<xacro:include filename="$(find pura_description)/urdf/_d435.gazebo.xacro" />
<xacro:include filename="$(find pura_description)/urdf/_d435i_imu_modules.urdf.xacro"/>
<xacro:arg name = "camera_topics" default="camera" />

        <xacro:property name="imu_size_x" value="0.004" />
        <xacro:property name="imu_size_y" value="0.006" />
        <xacro:property name="imu_size_z" value="0.001" />
        <xacro:property name="imu_mass" value="0.00001" />
        <xacro:property name="imu_offset_x" value="0.0095" />
        <xacro:property name="imu_offset_y" value="-0.029" />
        <xacro:property name="imu_offset_z" value="0.0021" />


<link name="robot_footprint"/>
<link name="base_link">
  <inertial>
    <origin rpy="0 0 0" xyz="-0.042752928200310555 0.0008081581737904212 0.5164386464136691"/>
    <mass value="29.51291752859557"/>
    <inertia ixx="5.154056" ixy="0.005489" ixz="0.753348" iyy="5.467321" iyz="0.003629" izz="1.3445"/>
  </inertial>
  <visual>
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin rpy="0 0 0" xyz="0 0 0"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/base_link.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

  <joint name="base_joint" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 0"/>
    <parent link="robot_footprint"/>
    <child link="base_link" />
  </joint>

<link name="wheel_right_1">
  <inertial>
    <origin rpy="0 0 0" xyz="2.062615339692986e-06 -0.03178029592257489 5.132057279144675e-11"/>
    <mass value="4.720587467091332"/>
    <inertia ixx="0.005213" ixy="-0.0" ixz="-0.0" iyy="0.008273" iyz="0.0" izz="0.005213"/>
  </inertial>
  <visual>
    <origin rpy="0 0 0" xyz="-0.149578 0.13356 -0.065082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/wheel_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin rpy="0 0 0" xyz="-0.149578 0.13356 -0.065082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/wheel_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="wheel_left_1">
  <inertial>
    <origin rpy="0 0 0" xyz="-1.5917620075356353e-06 0.031779753124860755 6.692799092711255e-11"/>
    <mass value="4.720587480727594"/>
    <inertia ixx="0.005213" ixy="-0.0" ixz="0.0" iyy="0.008273" iyz="0.0" izz="0.005213"/>
  </inertial>
  <visual>
    <origin rpy="0 0 0" xyz="-0.149578 -0.13244 -0.065082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/wheel_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin rpy="0 0 0" xyz="-0.149578 -0.13244 -0.065082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/wheel_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="caster_right_1">
  <inertial>
    <origin rpy="0 0 0" xyz="-0.013134349247133442 0.00015935639292946613 -0.03778065670884836"/>
    <mass value="0.7280604885172764"/>
    <inertia ixx="0.000486" ixy="1e-06" ixz="-0.000138" iyy="0.000598" iyz="2e-06" izz="0.000268"/>
  </inertial>
  <visual>
    <origin rpy="0 0 0" xyz="0.160422 0.16496 -0.083082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/caster_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin rpy="0 0 0" xyz="0.160422 0.16496 -0.083082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/caster_right_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="caster_left_1">
  <inertial>
    <origin rpy="0 0 0" xyz="-0.013134250371726636 0.0001599248576380774 -0.037780656709248024"/>
    <mass value="0.7280604885172761"/>
    <inertia ixx="0.000486" ixy="1e-06" ixz="-0.000138" iyy="0.000598" iyz="2e-06" izz="0.000268"/>
  </inertial>
  <visual>
    <origin rpy="0 0 0" xyz="0.162423 -0.163808 -0.083082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/caster_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin rpy="0 0 0" xyz="0.162423 -0.163808 -0.083082"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/caster_left_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="lidar_1">
  <inertial>
    <origin rpy="0 0 0" xyz="0.003552944991974838 0.001148428916374488 0.004806330098101247"/>
    <mass value="0.11031844097889323"/>
    <inertia ixx="3.4e-05" ixy="-1e-06" ixz="1e-06" iyy="3.7e-05" iyz="0.0" izz="6.8e-05"/>
  </inertial>
  <visual>
    <origin rpy="0 0 0" xyz="-0.18055 0.00033 -0.209582"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/lidar_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin rpy="0 0 0" xyz="-0.18055 0.00033 -0.209582"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/lidar_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="lidar_base_1">
  <inertial>
    <origin rpy="0 0 0" xyz="1.3784420221346627e-05 0.00013864423179526104 0.020136529563181266"/>
    <mass value="0.4541466021747772"/>
    <inertia ixx="0.000208" ixy="-0.0" ixz="3e-06" iyy="0.000204" iyz="-0.0" izz="0.000342"/>
  </inertial>
  <visual>
    <origin rpy="0 0 0" xyz="-0.181078 0.00056 -0.179582"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/lidar_base_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
    <material name="silver"/>
  </visual>
  <collision>
    <origin rpy="0 0 0" xyz="-0.181078 0.00056 -0.179582"/>
    <geometry>
      <mesh filename="package://pura_description/meshes/lidar_base_1.stl" scale="0.001 0.001 0.001"/>
    </geometry>
  </collision>
</link>

<link name="imu_link">
    <inertial>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <mass value="${imu_mass}" />
        <inertia ixx="${imu_mass*(imu_size_y*imu_size_y+imu_size_z*imu_size_z)}" ixy="0" ixz="0"
                  iyy="${imu_mass*(imu_size_x*imu_size_x+imu_size_z*imu_size_z)}" iyz="0"
                  izz="${imu_mass*(imu_size_x*imu_size_x+imu_size_y*imu_size_y)}" />
    </inertial>
    <visual>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <box size="${imu_size_x} ${imu_size_y} ${imu_size_z}" />
        </geometry>
        <material name="red" />
    </visual>
    <collision>
        <origin xyz="0 0 0" rpy="0 0 0" />
        <geometry>
            <box size="${imu_size_x} ${imu_size_y} ${imu_size_z}" />
        </geometry>
    </collision>
</link>
<joint name="imu_joint" type="fixed">
    <parent link="base_link" />
    <child link="imu_link" />
    <origin rpy="0 0 0" xyz="${imu_offset_x} ${imu_offset_y} ${imu_offset_z}"/>
</joint>

<!--xacro:include filename="$(find realsense_ros_gazebo)/xacro/depthcam.xacro"/>

<xacro:realsense_d435 sensor_name="d435" parent_link="base_link" rate="10">
  <origin rpy="0 0 0 " xyz="-0.113423 0 1.410089"/>
</xacro:realsense_d435-->


<joint name="motor_right" type="continuous">
  <origin rpy="0 0 0" xyz="0.149578 -0.13356 0.065082"/>
  <parent link="base_link"/>
  <child link="wheel_right_1"/>
  <axis xyz="0.0 1.0 0.0"/>
</joint>

<joint name="motor_left" type="continuous">
  <origin rpy="0 0 0" xyz="0.149578 0.13244 0.065082"/>
  <parent link="base_link"/>
  <child link="wheel_left_1"/>
  <axis xyz="-0.0 1.0 -0.0"/>
</joint>

<joint name="Rigid3" type="fixed">
  <origin rpy="0 0 0" xyz="-0.160422 -0.16496 0.083082"/>
  <parent link="base_link"/>
  <child link="caster_right_1"/>
</joint>

<joint name="Rigid4" type="fixed">
  <origin rpy="0 0 0" xyz="-0.162423 0.163808 0.083082"/>
  <parent link="base_link"/>
  <child link="caster_left_1"/>
</joint>

<joint name="Rigid7" type="fixed">
  <origin rpy="0 0 1.57" xyz="-0.000528 0.00023 0.03"/>
  <parent link="lidar_base_1"/>
  <child link="lidar_1"/>
</joint>

<joint name="Rigid8" type="fixed">
  <origin rpy="0 0 0" xyz="0.181078 -0.00056 0.179582"/>
  <parent link="base_link"/>
  <child link="lidar_base_1"/>
</joint>

<sensor_d435i parent="base_link" name = "$(arg camera_topics)" use_nominal_extrinsics = "True">
  <origin rpy="0 0 0 " xyz="-0.113423 0 1.0"/>
</sensor_d435i>

</robot>
